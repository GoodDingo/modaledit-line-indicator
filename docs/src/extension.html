
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            Project
        </title>
        <link rel="icon" type="image/icon" href="../images/favicon.svg" />
        <link rel="stylesheet" href="../dist/normal.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="../index.html" >
            
            <span>Project</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="camouflage">
        <a   onclick="document.body.theme('camouflage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Camouflage</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="greyhound">
        <a   onclick="document.body.theme('greyhound')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Greyhound</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            <pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="6" data-toggle="tooltip" data-title="typeof vscode">vscode</span> <span class="keyword">from</span> <span class="string">&#039;vscode&#039;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="40" data-toggle="tooltip" data-title="typeof fs">fs</span> <span class="keyword">from</span> <span class="string">&#039;fs&#039;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="66" data-toggle="tooltip" data-title="path.PlatformPath">path</span> <span class="keyword">from</span> <span class="string">&#039;path&#039;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span> <span id="98" data-toggle="tooltip" data-title="typeof ExtensionLogger">ExtensionLogger</span> <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&#039;./logging&#039;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span> <span id="143" data-toggle="tooltip" data-title="typeof ConfigurationManager">ConfigurationManager</span> <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&#039;./configuration&#039;</span><span class="punctuation">;</span>

<span class="keyword">type</span> <span id="190" class="typename" data-toggle="tooltip" data-title="Mode">Mode</span> <span class="punctuation">=</span> <span class="string">&#039;normal&#039;</span> <span class="punctuation">|</span> <span class="string">&#039;insert&#039;</span> <span class="punctuation">|</span> <span class="string">&#039;visual&#039;</span> <span class="punctuation">|</span> <span class="string">&#039;search&#039;</span><span class="punctuation">;</span>

<span class="keyword">interface</span> <span id="246" class="typename" data-toggle="tooltip" data-title="DecorationTypes">DecorationTypes</span> <span class="punctuation">{</span>
  <span id="275" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">TextEditorDecorationType</span><span class="punctuation">;</span>
  <span id="318" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">TextEditorDecorationType</span><span class="punctuation">;</span>
  <span id="361" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">TextEditorDecorationType</span><span class="punctuation">;</span>
  <span id="404" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">TextEditorDecorationType</span><span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="keyword">class</span> <span id="449" class="typename" data-toggle="tooltip" data-title="ModalEditLineIndicator">ModalEditLineIndicator</span> <span class="keyword">implements</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Disposable">Disposable</span> <span class="punctuation">{</span>
  <span class="keyword">private</span> <span id="510" data-toggle="tooltip" data-title="Mode">currentModeCache</span><span class="punctuation">:</span> <a href="extension.html#190"><span class="typename" data-toggle="tooltip" data-title="Mode">Mode</span></a> <span class="punctuation">=</span> <span class="string">&#039;insert&#039;</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="555" data-toggle="tooltip" data-title="DecorationTypes">decorations</span><span class="punctuation">:</span> <a href="extension.html#246"><span class="typename" data-toggle="tooltip" data-title="DecorationTypes">DecorationTypes</span></a><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="595" data-toggle="tooltip" data-title="boolean">enabled</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="623" data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Disposable">Disposable</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="672" data-toggle="tooltip" data-title="NodeJS.Timeout | null">updateDebounceTimer</span><span class="punctuation">:</span> <span data-toggle="tooltip" data-title="any">NodeJS</span><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="NodeJS.Timeout">Timeout</span> <span class="punctuation">|</span> <span class="keyword">null</span> <span class="punctuation">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span class="keyword">readonly</span> <span id="733" data-toggle="tooltip" data-title="10">DEBOUNCE_MS</span> <span class="punctuation">=</span> <span class="number">10</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="770" data-toggle="tooltip" data-title="NodeJS.Timeout | null">modePollTimer</span><span class="punctuation">:</span> <span data-toggle="tooltip" data-title="any">NodeJS</span><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="NodeJS.Timeout">Timeout</span> <span class="punctuation">|</span> <span class="keyword">null</span> <span class="punctuation">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span class="keyword">readonly</span> <span id="825" data-toggle="tooltip" data-title="50">MODE_POLL_MS</span> <span class="punctuation">=</span> <span class="number">50</span><span class="punctuation">;</span> <span class="comment">// Check mode every 50ms for instant detection</span>
  <span class="keyword">private</span> <span id="863" data-toggle="tooltip" data-title="ExtensionLogger">logger</span><span class="punctuation">:</span> <a href="extension.html#98"><span data-toggle="tooltip" data-title="ExtensionLogger">ExtensionLogger</span></a><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="945" data-toggle="tooltip" data-title="string">lastLoggedStateKey</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">=</span> <span class="string">&#039;&#039;</span><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="988" data-toggle="tooltip" data-title="ConfigurationManager">configManager</span><span class="punctuation">:</span> <a href="extension.html#143"><span data-toggle="tooltip" data-title="ConfigurationManager">ConfigurationManager</span></a><span class="punctuation">;</span>

  <span class="keyword">constructor</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="extension.html#98"><span data-toggle="tooltip" data-title="typeof ExtensionLogger">ExtensionLogger</span></a><span class="punctuation">(</span><span class="string">&#039;ModalEdit Line Indicator&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== ModalEditLineIndicator Constructor ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#988"><span data-toggle="tooltip" data-title="ConfigurationManager">configManager</span></a> <span class="punctuation">=</span> <a href="extension.html#143"><span data-toggle="tooltip" data-title="typeof ConfigurationManager">ConfigurationManager</span></a><span class="punctuation">.</span><a href="configuration.html#3351"><span class="member" data-toggle="tooltip" data-title="(logger?: Logger) =&gt; ConfigurationManager">getInstance</span></a><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="keyword">const</span> <span id="1272" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section?: string, scope?: vscode.ConfigurationScope | null) =&gt; vscode.WorkspaceConfiguration">getConfiguration</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a> <span class="punctuation">=</span> <a href="extension.html#1272"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><span class="keyword">boolean</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&#039;enabled&#039;</span><span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#1454"><span class="member" data-toggle="tooltip" data-title="() =&gt; DecorationTypes">createDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  /**
   * Creates text editor decoration types for all 4 modes.
   * Each mode has its own background, border color, border style, and border width.
   *
   * @returns
</code></pre>
<p>Creates text editor decoration types for all 4 modes.
Each mode has its own background, border color, border style, and border width.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="1454" class="member" data-toggle="tooltip" data-title="() =&gt; DecorationTypes">createDecorations</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="extension.html#246"><span class="typename" data-toggle="tooltip" data-title="DecorationTypes">DecorationTypes</span></a> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Creating decorations for 4 modes&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Helper function to create decoration for a specific mode</span>
    <span class="keyword">const</span> <span id="1891" data-toggle="tooltip" data-title="(mode: Mode) =&gt; vscode.TextEditorDecorationType">createModeDecoration</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span id="1916" data-toggle="tooltip" data-title="Mode">mode</span><span class="punctuation">:</span> <a href="extension.html#190"><span class="typename" data-toggle="tooltip" data-title="Mode">Mode</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">TextEditorDecorationType</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <span class="keyword">const</span> <span id="1977" data-toggle="tooltip" data-title="MergedModeConfig">merged</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#988"><span data-toggle="tooltip" data-title="ConfigurationManager">configManager</span></a><span class="punctuation">.</span><a href="configuration.html#3927"><span class="member" data-toggle="tooltip" data-title="(mode: &quot;normal&quot; | &quot;insert&quot; | &quot;visual&quot; | &quot;search&quot;) =&gt; MergedModeConfig">getConfig</span></a><span class="punctuation">(</span><a href="extension.html#1916"><span data-toggle="tooltip" data-title="Mode">mode</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span>
        <span class="string">`  ${</span><a href="extension.html#1916"><span data-toggle="tooltip" data-title="Mode">mode</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="string">}: bg=${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1533"><span data-toggle="tooltip" data-title="string">background</span></a><span class="string">}, border=${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1596"><span data-toggle="tooltip" data-title="string">borderWidth</span></a><span class="string">} ${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1573"><span data-toggle="tooltip" data-title="string">borderStyle</span></a><span class="string">} ${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1555"><span data-toggle="tooltip" data-title="string">border</span></a><span class="string">}`</span>
      <span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">return</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(options: vscode.DecorationRenderOptions) =&gt; vscode.TextEditorDecorationType">createTextEditorDecorationType</span><span class="punctuation">(</span><span class="punctuation">{</span>
        <span id="2244" data-toggle="tooltip" data-title="string">backgroundColor</span><span class="punctuation">:</span> <a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1533"><span data-toggle="tooltip" data-title="string">background</span></a><span class="punctuation">,</span>
        <span id="2288" data-toggle="tooltip" data-title="string">border</span><span class="punctuation">:</span> <span class="string">`${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1596"><span data-toggle="tooltip" data-title="string">borderWidth</span></a><span class="string">} ${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1573"><span data-toggle="tooltip" data-title="string">borderStyle</span></a><span class="string">} ${</span><a href="extension.html#1977"><span data-toggle="tooltip" data-title="MergedModeConfig">merged</span></a><span class="punctuation">.</span><a href="configuration.html#1555"><span data-toggle="tooltip" data-title="string">border</span></a><span class="string">}`</span><span class="punctuation">,</span>
        <span id="2368" data-toggle="tooltip" data-title="true">isWholeLine</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">;</span>

    <span class="keyword">return</span> <span class="punctuation">{</span>
      <span id="2426" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span><span class="punctuation">:</span> <a href="extension.html#1891"><span data-toggle="tooltip" data-title="(mode: Mode) =&gt; vscode.TextEditorDecorationType">createModeDecoration</span></a><span class="punctuation">(</span><span class="string">&#039;normal&#039;</span><span class="punctuation">)</span><span class="punctuation">,</span>
      <span id="2472" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span><span class="punctuation">:</span> <a href="extension.html#1891"><span data-toggle="tooltip" data-title="(mode: Mode) =&gt; vscode.TextEditorDecorationType">createModeDecoration</span></a><span class="punctuation">(</span><span class="string">&#039;insert&#039;</span><span class="punctuation">)</span><span class="punctuation">,</span>
      <span id="2518" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span><span class="punctuation">:</span> <a href="extension.html#1891"><span data-toggle="tooltip" data-title="(mode: Mode) =&gt; vscode.TextEditorDecorationType">createModeDecoration</span></a><span class="punctuation">(</span><span class="string">&#039;visual&#039;</span><span class="punctuation">)</span><span class="punctuation">,</span>
      <span id="2564" data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span><span class="punctuation">:</span> <a href="extension.html#1891"><span data-toggle="tooltip" data-title="(mode: Mode) =&gt; vscode.TextEditorDecorationType">createModeDecoration</span></a><span class="punctuation">(</span><span class="string">&#039;search&#039;</span><span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">}</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  /**
   * Detects the current ModalEdit mode using cursor style and selection state.
   *
   * ModalEdit by default uses different cursor styles for different modes, though users
   * can configure which styles to use. The key insight: we can detect VISUAL mode reliably
   * by checking if there's an active selection, regardless of cursor styles.
   *
   * Mode detection strategy:
   * 1. Check if editor has a selection (selection.anchor != selection.active)
   * 2. If yes, and cursor is NOT the INSERT cursor → likely VISUAL mode
   * 3. Otherwise, detect based on cursor style patterns
   *
   * This works because:
   * - INSERT mode: Always uses thin cursor (Line/LineThin variants)
   * - NORMAL mode: Uses block cursor variants, NO selection
   * - VISUAL mode: Uses ANY cursor style, WITH selection
   * - SEARCH mode: Uses distinctive cursor (typically Underline variants)
   *
   * @returns
</code></pre>
<p>Detects the current ModalEdit mode using cursor style and selection state.</p>
<p>ModalEdit by default uses different cursor styles for different modes, though users
can configure which styles to use. The key insight: we can detect VISUAL mode reliably
by checking if there's an active selection, regardless of cursor styles.</p>
<p>Mode detection strategy:</p>
<ol>
<li>Check if editor has a selection (selection.anchor != selection.active)</li>
<li>If yes, and cursor is NOT the INSERT cursor → likely VISUAL mode</li>
<li>Otherwise, detect based on cursor style patterns</li>
</ol>
<p>This works because:</p>
<ul>
<li>INSERT mode: Always uses thin cursor (Line/LineThin variants)</li>
<li>NORMAL mode: Uses block cursor variants, NO selection</li>
<li>VISUAL mode: Uses ANY cursor style, WITH selection</li>
<li>SEARCH mode: Uses distinctive cursor (typically Underline variants)</li>
</ul>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="2621" class="member" data-toggle="tooltip" data-title="() =&gt; Mode">detectCurrentMode</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="extension.html#190"><span class="typename" data-toggle="tooltip" data-title="Mode">Mode</span></a> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span id="3643" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#3643"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">return</span> <span class="string">&#039;insert&#039;</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">const</span> <span id="3743" data-toggle="tooltip" data-title="number | undefined">cursorStyle</span> <span class="punctuation">=</span> <a href="extension.html#3643"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorOptions">options</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle | undefined">cursorStyle</span> <span class="keyword">as</span> <span class="keyword">number</span> <span class="punctuation">|</span> <span class="keyword">undefined</span><span class="punctuation">;</span>
    <span class="keyword">const</span> <span id="3817" data-toggle="tooltip" data-title="boolean">hasSelection</span> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="extension.html#3643"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">isEmpty</span><span class="punctuation">;</span>

    <span class="comment">// Only log when state changes</span>
    <span class="keyword">const</span> <span id="3905" data-toggle="tooltip" data-title="string">stateKey</span> <span class="punctuation">=</span> <span class="string">`${</span><a href="extension.html#3743"><span data-toggle="tooltip" data-title="number | undefined">cursorStyle</span></a><span class="string">}-${</span><a href="extension.html#3817"><span data-toggle="tooltip" data-title="boolean">hasSelection</span></a><span class="string">}`</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#3905"><span data-toggle="tooltip" data-title="string">stateKey</span></a> <span class="punctuation">!==</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#945"><span data-toggle="tooltip" data-title="string">lastLoggedStateKey</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2768"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">debug</span></a><span class="punctuation">(</span><span class="string">`Cursor: ${</span><a href="extension.html#3743"><span data-toggle="tooltip" data-title="number | undefined">cursorStyle</span></a><span class="string">}, Selection: ${</span><a href="extension.html#3817"><span data-toggle="tooltip" data-title="boolean">hasSelection</span></a><span class="string">}`</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#945"><span data-toggle="tooltip" data-title="string">lastLoggedStateKey</span></a> <span class="punctuation">=</span> <a href="extension.html#3905"><span data-toggle="tooltip" data-title="string">stateKey</span></a><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="comment">// Priority 1: If there&#039;s a selection and we&#039;re NOT in LINE cursor → VISUAL mode</span>
    <span class="comment">// This handles all cursor configurations where VISUAL mode has a selection</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#3817"><span data-toggle="tooltip" data-title="boolean">hasSelection</span></a> <span class="punctuation">&amp;&amp;</span> <a href="extension.html#3743"><span data-toggle="tooltip" data-title="number | undefined">cursorStyle</span></a> <span class="punctuation">!==</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Line">Line</span><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">return</span> <span class="string">&#039;visual&#039;</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="comment">// Priority 2: Detect based on cursor style</span>
    <span class="keyword">switch</span> <span class="punctuation">(</span><a href="extension.html#3743"><span data-toggle="tooltip" data-title="number | undefined">cursorStyle</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Block">Block</span><span class="punctuation">:</span> <span class="comment">// 2 - Typical NORMAL mode</span>
      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.BlockOutline">BlockOutline</span><span class="punctuation">:</span> <span class="comment">// 5 - Alternative NORMAL/VISUAL</span>
        <span class="keyword">return</span> <a href="extension.html#3817"><span data-toggle="tooltip" data-title="boolean">hasSelection</span></a> <span class="punctuation">?</span> <span class="string">&#039;visual&#039;</span> <span class="punctuation">:</span> <span class="string">&#039;normal&#039;</span><span class="punctuation">;</span>

      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Underline">Underline</span><span class="punctuation">:</span> <span class="comment">// 3 - Typical SEARCH mode</span>
      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.UnderlineThin">UnderlineThin</span><span class="punctuation">:</span> <span class="comment">// 6 - Alternative SEARCH</span>
        <span class="keyword">return</span> <span class="string">&#039;search&#039;</span><span class="punctuation">;</span>

      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.LineThin">LineThin</span><span class="punctuation">:</span> <span class="comment">// 4 - Could be VISUAL or INSERT</span>
        <span class="keyword">return</span> <a href="extension.html#3817"><span data-toggle="tooltip" data-title="boolean">hasSelection</span></a> <span class="punctuation">?</span> <span class="string">&#039;visual&#039;</span> <span class="punctuation">:</span> <span class="string">&#039;insert&#039;</span><span class="punctuation">;</span>

      <span class="keyword">case</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Line">Line</span><span class="punctuation">:</span> <span class="comment">// 1 - Typical INSERT mode</span>
      <span class="keyword">default</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="string">&#039;insert&#039;</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Update the line highlight based on current mode
Debounced to avoid excessive updates during rapid mode switches</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span class="keyword">async</span> <span id="5129" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">return</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">const</span> <span id="5371" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#5371"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">return</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="comment">// Debounce rapid successive calls</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">updateDebounceTimer</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="member" data-toggle="tooltip" data-title="(timeout: NodeJS.Timeout | string | number | undefined) =&gt; void">clearTimeout</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout">updateDebounceTimer</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">updateDebounceTimer</span></a> <span class="punctuation">=</span> <span class="member" data-toggle="tooltip" data-title="typeof setTimeout">setTimeout</span><span class="punctuation">(</span><span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <span class="comment">// Re-check active editor in case it changed during debounce</span>
      <span class="keyword">const</span> <span id="5715" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">currentEditor</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#5715"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">currentEditor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5880"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; void">applyDecorations</span></a><span class="punctuation">(</span><a href="extension.html#5715"><span data-toggle="tooltip" data-title="vscode.TextEditor">currentEditor</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span><span class="punctuation">,</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#733"><span data-toggle="tooltip" data-title="10">DEBOUNCE_MS</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  /**
   * Applies decorations to an editor based on the current mode.
   * Only one decoration type is applied at a time (exclusive).
   *
   * @<a href="extension.html#6116"><span data-toggle="tooltip" data-title="any">param</span></a> <a href="extension.html#6116"><span data-toggle="tooltip" data-title="any">editor</span></a>
</code></pre>
<p>Applies decorations to an editor based on the current mode.
Only one decoration type is applied at a time (exclusive).</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="5880" class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; void">applyDecorations</span><span class="punctuation">(</span><span id="6116" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditor">TextEditor</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="keyword">try</span> <span class="punctuation">{</span>
      <span class="keyword">const</span> <span id="6172" data-toggle="tooltip" data-title="string">fileName</span> <span class="punctuation">=</span> <a href="extension.html#66"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string, suffix?: string) =&gt; string">basename</span><span class="punctuation">(</span><a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">const</span> <span id="6236" data-toggle="tooltip" data-title="number">cursorLine</span> <span class="punctuation">=</span> <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span><span class="punctuation">;</span>

      <span class="keyword">const</span> <span id="6292" data-toggle="tooltip" data-title="Mode">currentMode</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#2621"><span class="member" data-toggle="tooltip" data-title="() =&gt; Mode">detectCurrentMode</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Only log when mode actually changes</span>
      <span class="keyword">const</span> <span id="6390" data-toggle="tooltip" data-title="boolean">modeChanged</span> <span class="punctuation">=</span> <a href="extension.html#6292"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a> <span class="punctuation">!==</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#510"><span data-toggle="tooltip" data-title="Mode">currentModeCache</span></a><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#6390"><span data-toggle="tooltip" data-title="boolean">modeChanged</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;🎨 MODE CHANGED&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
          <span id="6513" data-toggle="tooltip" data-title="string">from</span><span class="punctuation">:</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#510"><span data-toggle="tooltip" data-title="Mode">currentModeCache</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>
          <span id="6566" data-toggle="tooltip" data-title="string">to</span><span class="punctuation">:</span> <a href="extension.html#6292"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>
          <span id="6607" data-toggle="tooltip" data-title="number">line</span><span class="punctuation">:</span> <a href="extension.html#6236"><span data-toggle="tooltip" data-title="number">cursorLine</span></a><span class="punctuation">,</span>
          <span id="6635" data-toggle="tooltip" data-title="string">file</span><span class="punctuation">:</span> <a href="extension.html#6172"><span data-toggle="tooltip" data-title="string">fileName</span></a><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#510"><span data-toggle="tooltip" data-title="Mode">currentModeCache</span></a> <span class="punctuation">=</span> <a href="extension.html#6292"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="comment">// Get the line(s) to decorate</span>
      <span class="keyword">const</span> <span id="6776" data-toggle="tooltip" data-title="vscode.Range[]">ranges</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#7896"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; vscode.Range[]">getDecorateRanges</span></a><span class="punctuation">(</span><a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Clear all decorations first</span>
      <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Apply decoration for current mode only</span>
      <span class="keyword">switch</span> <span class="punctuation">(</span><a href="extension.html#6292"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">case</span> <span class="string">&#039;normal&#039;</span><span class="punctuation">:</span>
          <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">,</span> <a href="extension.html#6776"><span data-toggle="tooltip" data-title="vscode.Range[]">ranges</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="string">&#039;insert&#039;</span><span class="punctuation">:</span>
          <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">,</span> <a href="extension.html#6776"><span data-toggle="tooltip" data-title="vscode.Range[]">ranges</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="string">&#039;visual&#039;</span><span class="punctuation">:</span>
          <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">,</span> <a href="extension.html#6776"><span data-toggle="tooltip" data-title="vscode.Range[]">ranges</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="string">&#039;search&#039;</span><span class="punctuation">:</span>
          <a href="extension.html#6116"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">,</span> <a href="extension.html#6776"><span data-toggle="tooltip" data-title="vscode.Range[]">ranges</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">break</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="comment">// Only log when mode changed</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#6390"><span data-toggle="tooltip" data-title="boolean">modeChanged</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2768"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">debug</span></a><span class="punctuation">(</span>
          <span class="string">`Applied ${</span><a href="extension.html#6292"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="string">} mode decoration to ${</span><a href="extension.html#6776"><span data-toggle="tooltip" data-title="vscode.Range[]">ranges</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="string">} range(s)`</span>
        <span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span> <span class="keyword">catch</span> <span class="punctuation">(</span><span id="7813" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3275"><span class="member" data-toggle="tooltip" data-title="(message: string, error?: unknown) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">&#039;Error updating line highlight&#039;</span><span class="punctuation">,</span> <a href="extension.html#7813"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Calculate which line ranges should be decorated
Always highlights only the current cursor line</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="7896" class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; vscode.Range[]">getDecorateRanges</span><span class="punctuation">(</span><span id="8043" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditor">TextEditor</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Range">Range</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="comment">// Only highlight the current cursor line</span>
    <span class="keyword">const</span> <span id="8143" data-toggle="tooltip" data-title="number">cursorLine</span> <span class="punctuation">=</span> <a href="extension.html#8043"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span><span class="punctuation">;</span>
    <span class="keyword">return</span> <span class="punctuation">[</span><span class="keyword">new</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Range">Range</span><span class="punctuation">(</span><a href="extension.html#8143"><span data-toggle="tooltip" data-title="number">cursorLine</span></a><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <a href="extension.html#8143"><span data-toggle="tooltip" data-title="number">cursorLine</span></a><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Clear all decorations from all visible editors</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="8251" class="member" data-toggle="tooltip" data-title="() =&gt; void">clearAllDecorations</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.TextEditor[]">visibleTextEditors</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: vscode.TextEditor, index: number, array: readonly vscode.TextEditor[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span><span id="8402" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <a href="extension.html#8402"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#8402"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#8402"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#8402"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Reloads decorations when configuration changes.
Disposes old decoration types and creates new ones with updated settings.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="8657" class="member" data-toggle="tooltip" data-title="() =&gt; void">reloadDecorations</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Reloading decorations (config changed)&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Dispose old decorations</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Create new decorations with updated config</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#1454"><span class="member" data-toggle="tooltip" data-title="() =&gt; DecorationTypes">createDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Reapply to all visible editors only if extension is enabled</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">const</span> <span id="9300" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span> <span class="keyword">of</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.TextEditor[]">visibleTextEditors</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5880"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; void">applyDecorations</span></a><span class="punctuation">(</span><a href="extension.html#9300"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Register all event listeners and commands</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="9403" class="member" data-toggle="tooltip" data-title="() =&gt; void">registerListeners</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="comment">// Update on selection/cursor change</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Event&lt;vscode.TextEditorSelectionChangeEvent&gt;">onDidChangeTextEditorSelection</span><span class="punctuation">(</span><span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Update on active editor change</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Event&lt;vscode.TextEditor | undefined&gt;">onDidChangeActiveTextEditor</span><span class="punctuation">(</span><span class="keyword">async</span> <span id="9808" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">e</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#9808"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">e</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">await</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Manual update command</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.updateHighlight&#039;</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
      <span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Toggle enabled/disabled</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.toggleEnabled&#039;</span><span class="punctuation">,</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">const</span> <span id="10256" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section?: string, scope?: vscode.ConfigurationScope | null) =&gt; vscode.WorkspaceConfiguration">getConfiguration</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">const</span> <span id="10342" data-toggle="tooltip" data-title="boolean">newValue</span> <span class="punctuation">=</span> <span class="punctuation">!</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a><span class="punctuation">;</span>

        <span class="comment">// Persist to configuration</span>
        <span class="keyword">await</span> <a href="extension.html#10256"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section: string, value: any, configurationTarget?: vscode.ConfigurationTarget | boolean | null, overrideInLanguage?: boolean) =&gt; Thenable&lt;void&gt;">update</span><span class="punctuation">(</span><span class="string">&#039;enabled&#039;</span><span class="punctuation">,</span> <a href="extension.html#10342"><span data-toggle="tooltip" data-title="boolean">newValue</span></a><span class="punctuation">,</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.ConfigurationTarget">ConfigurationTarget</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.ConfigurationTarget.Global">Global</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <span class="comment">// Update in-memory state</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a> <span class="punctuation">=</span> <a href="extension.html#10342"><span data-toggle="tooltip" data-title="boolean">newValue</span></a><span class="punctuation">;</span>

        <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#15388"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">startModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">await</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span><span class="string">&#039;ModalEdit Line Indicator: Enabled&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span> <span class="keyword">else</span> <span class="punctuation">{</span>
          <span class="comment">// Clear all decorations and stop polling</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#8251"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">clearAllDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#16383"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">stopModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span><span class="string">&#039;ModalEdit Line Indicator: Disabled&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Listen for configuration changes</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Event&lt;vscode.ConfigurationChangeEvent&gt;">onDidChangeConfiguration</span><span class="punctuation">(</span><span id="11117" data-toggle="tooltip" data-title="vscode.ConfigurationChangeEvent">e</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">const</span> <span id="11137" data-toggle="tooltip" data-title="boolean">affectsUs</span> <span class="punctuation">=</span> <a href="extension.html#11117"><span data-toggle="tooltip" data-title="vscode.ConfigurationChangeEvent">e</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section: string, scope?: vscode.ConfigurationScope) =&gt; boolean">affectsConfiguration</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2768"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">debug</span></a><span class="punctuation">(</span><span class="string">&#039;⚙️  EVENT: onDidChangeConfiguration&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
          <span id="11268" data-toggle="tooltip" data-title="boolean">affectsUs</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#11117"><span data-toggle="tooltip" data-title="vscode.ConfigurationChangeEvent">e</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section: string, scope?: vscode.ConfigurationScope) =&gt; boolean">affectsConfiguration</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.enabled&#039;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="comment">// Enabled state changed</span>
          <span class="keyword">const</span> <span id="11427" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section?: string, scope?: vscode.ConfigurationScope | null) =&gt; vscode.WorkspaceConfiguration">getConfiguration</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">const</span> <span id="11515" data-toggle="tooltip" data-title="boolean">newEnabled</span> <span class="punctuation">=</span> <a href="extension.html#11427"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><span class="keyword">boolean</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&#039;enabled&#039;</span><span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span><span class="punctuation">;</span>

          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">`Extension ${</span><a href="extension.html#11515"><span data-toggle="tooltip" data-title="boolean">newEnabled</span></a> <span class="punctuation">?</span> <span class="string">&#039;enabled&#039;</span> <span class="punctuation">:</span> <span class="string">&#039;disabled&#039;</span><span class="string">}`</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#595"><span data-toggle="tooltip" data-title="boolean">enabled</span></a> <span class="punctuation">=</span> <a href="extension.html#11515"><span data-toggle="tooltip" data-title="boolean">newEnabled</span></a><span class="punctuation">;</span>

          <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#11515"><span data-toggle="tooltip" data-title="boolean">newEnabled</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="comment">// When disabling, clear all decorations and stop polling immediately</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#8251"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">clearAllDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#16383"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">stopModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span> <span class="keyword">else</span> <span class="punctuation">{</span>
            <span class="comment">// When enabling, start polling and apply decorations</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#15388"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">startModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span>
        <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#11137"><span data-toggle="tooltip" data-title="boolean">affectsUs</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="comment">// Visual properties changed - need to reload decorations</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Configuration changed - reloading decorations&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#8657"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">reloadDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Listen for theme changes and reload decorations</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Event&lt;vscode.ColorTheme&gt;">onDidChangeActiveColorTheme</span><span class="punctuation">(</span><span id="12411" data-toggle="tooltip" data-title="vscode.ColorTheme">theme</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">`Color theme changed to: ${</span><a href="extension.html#12411"><span data-toggle="tooltip" data-title="vscode.ColorTheme">theme</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.ColorThemeKind">kind</span><span class="string">} - reloading decorations`</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#8657"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">reloadDecorations</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Command: Show log file location</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.showLogFile&#039;</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">const</span> <span id="12728" data-toggle="tooltip" data-title="string">logPath</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#4080"><span class="member" data-toggle="tooltip" data-title="() =&gt; string">getLogFilePath</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span>
            <span class="string">`Log file: ${</span><a href="extension.html#12728"><span data-toggle="tooltip" data-title="string">logPath</span></a><span class="string">}`</span><span class="punctuation">,</span>
            <span class="string">&#039;Open File&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Copy Path&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Reveal in Finder/Explorer&#039;</span>
          <span class="punctuation">)</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = &quot;Open File&quot; | &quot;Copy Path&quot; | &quot;Reveal in Finder/Explorer&quot; | undefined, TResult2 = never&gt;(onfulfilled?: ((value: &quot;Open File&quot; | &quot;Copy Path&quot; | &quot;Reveal in Finder/Explorer&quot; | undefined) =&gt; TResult1 | PromiseLike&lt;...&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | ... 1 more ....">then</span><span class="punctuation">(</span><span id="12981" data-toggle="tooltip" data-title="&quot;Open File&quot; | &quot;Copy Path&quot; | &quot;Reveal in Finder/Explorer&quot; | undefined">choice</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#12981"><span data-toggle="tooltip" data-title="&quot;Open File&quot; | &quot;Copy Path&quot; | &quot;Reveal in Finder/Explorer&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Open File&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (uri: vscode.Uri, options?: { readonly encoding?: string; }): Thenable&lt;vscode.TextDocument&gt;; (path: string, options?: { readonly encoding?: string; }): Thenable&lt;vscode.TextDocument&gt;; (options?: { language?: string; content?: string; readonly encoding?: string; }): Thenable&lt;vscode.TextDocument&gt;; }">openTextDocument</span><span class="punctuation">(</span><a href="extension.html#12728"><span data-toggle="tooltip" data-title="string">logPath</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = vscode.TextDocument, TResult2 = never&gt;(onfulfilled?: ((value: vscode.TextDocument) =&gt; TResult1 | PromiseLike&lt;TResult1&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | ... 1 more ... | undefined) =&gt; PromiseLike&lt;...&gt;">then</span><span class="punctuation">(</span><span id="13097" data-toggle="tooltip" data-title="vscode.TextDocument">doc</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
                <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (document: vscode.TextDocument, column?: vscode.ViewColumn, preserveFocus?: boolean): Thenable&lt;vscode.TextEditor&gt;; (document: vscode.TextDocument, options?: vscode.TextDocumentShowOptions): Thenable&lt;vscode.TextEditor&gt;; (uri: vscode.Uri, options?: vscode.TextDocumentShowOptions): Thenable&lt;vscode.TextEditor&gt;; }">showTextDocument</span><span class="punctuation">(</span><a href="extension.html#13097"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
              <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#12981"><span data-toggle="tooltip" data-title="&quot;Copy Path&quot; | &quot;Reveal in Finder/Explorer&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Copy Path&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.env">env</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Clipboard">clipboard</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(value: string) =&gt; Thenable&lt;void&gt;">writeText</span><span class="punctuation">(</span><a href="extension.html#12728"><span data-toggle="tooltip" data-title="string">logPath</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span><span class="string">&#039;Path copied to clipboard&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#12981"><span data-toggle="tooltip" data-title="&quot;Reveal in Finder/Explorer&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Reveal in Finder/Explorer&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&#039;revealFileInOS&#039;</span><span class="punctuation">,</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Uri">Uri</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string) =&gt; vscode.Uri">file</span><span class="punctuation">(</span><a href="extension.html#12728"><span data-toggle="tooltip" data-title="string">logPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span>
          <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Command: Manual mode query</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.queryMode&#039;</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== MANUAL MODE QUERY TRIGGERED ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <span class="keyword">const</span> <span id="13784" data-toggle="tooltip" data-title="Mode">currentMode</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#2621"><span class="member" data-toggle="tooltip" data-title="() =&gt; Mode">detectCurrentMode</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">const</span> <span id="13838" data-toggle="tooltip" data-title="{ normal: string; insert: string; visual: string; search: string; }">modeColorMap</span> <span class="punctuation">=</span> <span class="punctuation">{</span>
          <span id="13855" data-toggle="tooltip" data-title="string">normal</span><span class="punctuation">:</span> <span class="string">&#039;green dotted&#039;</span><span class="punctuation">,</span>
          <span id="13889" data-toggle="tooltip" data-title="string">insert</span><span class="punctuation">:</span> <span class="string">&#039;red solid&#039;</span><span class="punctuation">,</span>
          <span id="13920" data-toggle="tooltip" data-title="string">visual</span><span class="punctuation">:</span> <span class="string">&#039;blue dashed&#039;</span><span class="punctuation">,</span>
          <span id="13953" data-toggle="tooltip" data-title="string">search</span><span class="punctuation">:</span> <span class="string">&#039;yellow solid&#039;</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">;</span>
        <span class="keyword">const</span> <span id="14012" data-toggle="tooltip" data-title="string">modeDescription</span> <span class="punctuation">=</span> <a href="extension.html#13838"><span data-toggle="tooltip" data-title="{ normal: string; insert: string; visual: string; search: string; }">modeColorMap</span></a><span class="punctuation">[</span><a href="extension.html#13784"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">]</span><span class="punctuation">;</span>

        <span class="keyword">const</span> <span id="14072" data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.extensions">extensions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = any&gt;(extensionId: string) =&gt; vscode.Extension&lt;T&gt; | undefined">getExtension</span><span class="punctuation">(</span><span class="string">&#039;johtela.vscode-modaledit&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">const</span> <span id="14161" data-toggle="tooltip" data-title="string">modalEditInfo</span> <span class="punctuation">=</span> <a href="extension.html#14072"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span></a>
          <span class="punctuation">?</span> <span class="string">`ModalEdit v${</span><a href="extension.html#14072"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="any">packageJSON</span><span class="punctuation">.</span>version<span class="string">} (active: ${</span><a href="extension.html#14072"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">isActive</span><span class="string">})`</span>
          <span class="punctuation">:</span> <span class="string">&#039;ModalEdit NOT installed&#039;</span><span class="punctuation">;</span>

        <span class="keyword">const</span> <span id="14340" data-toggle="tooltip" data-title="string">message</span> <span class="punctuation">=</span> <span class="string">`Current Mode: ${</span><a href="extension.html#13784"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="string">} (${</span><a href="extension.html#14012"><span data-toggle="tooltip" data-title="string">modeDescription</span></a><span class="string">})\n${</span><a href="extension.html#14161"><span data-toggle="tooltip" data-title="string">modalEditInfo</span></a><span class="string">}`</span><span class="punctuation">;</span>

        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Manual query result&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
          <span id="14485" data-toggle="tooltip" data-title="Mode">mode</span><span class="punctuation">:</span> <a href="extension.html#13784"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">,</span>
          <span id="14514" data-toggle="tooltip" data-title="boolean">modalEditPresent</span><span class="punctuation">:</span> <span class="punctuation">!</span><span class="punctuation">!</span><a href="extension.html#14072"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span></a><span class="punctuation">,</span>
          <span id="14558" data-toggle="tooltip" data-title="boolean | undefined">modalEditActive</span><span class="punctuation">:</span> <a href="extension.html#14072"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span></a><span class="punctuation">?.</span><span data-toggle="tooltip" data-title="boolean | undefined">isActive</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span><a href="extension.html#14340"><span data-toggle="tooltip" data-title="string">message</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Command: Clear log file</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: vscode.Disposable[]) =&gt; number">push</span><span class="punctuation">(</span>
      <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&#039;modaledit-line-indicator.clearLog&#039;</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">try</span> <span class="punctuation">{</span>
          <span class="keyword">const</span> <span id="14865" data-toggle="tooltip" data-title="string">logPath</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#4080"><span class="member" data-toggle="tooltip" data-title="() =&gt; string">getLogFilePath</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <a href="extension.html#40"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(file: fs.PathOrFileDescriptor, data: string | NodeJS.ArrayBufferView, options?: fs.WriteFileOptions) =&gt; void">writeFileSync</span><span class="punctuation">(</span><a href="extension.html#14865"><span data-toggle="tooltip" data-title="string">logPath</span></a><span class="punctuation">,</span> <span class="string">&#039;&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== LOG CLEARED BY USER ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span><span class="string">&#039;Log file cleared&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span> <span class="keyword">catch</span> <span class="punctuation">(</span><span id="15090" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">const</span> <span id="15114" data-toggle="tooltip" data-title="Error">err</span> <span class="punctuation">=</span> <a href="extension.html#15090"><span data-toggle="tooltip" data-title="unknown">error</span></a> <span class="keyword">as</span> <span class="typename" data-toggle="tooltip" data-title="Error">Error</span><span class="punctuation">;</span>
          <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showErrorMessage</span><span class="punctuation">(</span>
            <span class="string">`Failed to clear log file: ${</span><a href="extension.html#15114"><span data-toggle="tooltip" data-title="Error">err</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">message</span><span class="string">}. Try manually deleting: ${</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#4080"><span class="member" data-toggle="tooltip" data-title="() =&gt; string">getLogFilePath</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="string">}`</span>
          <span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3275"><span class="member" data-toggle="tooltip" data-title="(message: string, error?: unknown) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">&#039;Clear log failed&#039;</span><span class="punctuation">,</span> <a href="extension.html#15090"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Start polling mode to detect mode changes via cursor style
This is needed because VS Code doesn't fire events when cursor style changes</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="15388" class="member" data-toggle="tooltip" data-title="() =&gt; void">startModePolling</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="comment">// Don&#039;t start if already running</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#770"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">modePollTimer</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2768"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">debug</span></a><span class="punctuation">(</span><span class="string">&#039;Mode polling already running, skipping start&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">return</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Starting mode polling (every 50ms)...&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#770"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">modePollTimer</span></a> <span class="punctuation">=</span> <span class="member" data-toggle="tooltip" data-title="{ &lt;TArgs extends any[]&gt;(callback: (...args: TArgs) =&gt; void, delay?: number, ...args: TArgs): NodeJS.Timeout; (callback: (_: void) =&gt; void, delay?: number): NodeJS.Timeout; }">setInterval</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <span class="keyword">const</span> <span id="15866" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#15866"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">return</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="keyword">const</span> <span id="15965" data-toggle="tooltip" data-title="Mode">currentMode</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#2621"><span class="member" data-toggle="tooltip" data-title="() =&gt; Mode">detectCurrentMode</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Only update if mode actually changed</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#15965"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a> <span class="punctuation">!==</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#510"><span data-toggle="tooltip" data-title="Mode">currentModeCache</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2768"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">debug</span></a><span class="punctuation">(</span><span class="string">&#039;🔄 Mode changed (poll)&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
          <span id="16157" data-toggle="tooltip" data-title="string">from</span><span class="punctuation">:</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#510"><span data-toggle="tooltip" data-title="Mode">currentModeCache</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>
          <span id="16210" data-toggle="tooltip" data-title="string">to</span><span class="punctuation">:</span> <a href="extension.html#15965"><span data-toggle="tooltip" data-title="Mode">currentMode</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5129"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">updateHighlight</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span><span class="punctuation">,</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#825"><span data-toggle="tooltip" data-title="50">MODE_POLL_MS</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;✅ Mode polling started&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Stop mode polling</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="16383" class="member" data-toggle="tooltip" data-title="() =&gt; void">stopModePolling</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#770"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">modePollTimer</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="member" data-toggle="tooltip" data-title="(timeout: NodeJS.Timeout | string | number | undefined) =&gt; void">clearInterval</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#770"><span data-toggle="tooltip" data-title="NodeJS.Timeout">modePollTimer</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#770"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">modePollTimer</span></a> <span class="punctuation">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Mode polling stopped&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Initialize the extension</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">public</span> <span class="keyword">async</span> <span id="16616" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">activate</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">try</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== ACTIVATION START ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Check for ModalEdit extension</span>
      <span class="keyword">const</span> <span id="16815" data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span> <span class="punctuation">=</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.extensions">extensions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = any&gt;(extensionId: string) =&gt; vscode.Extension&lt;T&gt; | undefined">getExtension</span><span class="punctuation">(</span><span class="string">&#039;johtela.vscode-modaledit&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt; | undefined">modalEditExt</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;ModalEdit extension FOUND&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
          <span id="16972" data-toggle="tooltip" data-title="string">id</span><span class="punctuation">:</span> <a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">id</span><span class="punctuation">,</span>
          <span id="17003" data-toggle="tooltip" data-title="any">version</span><span class="punctuation">:</span> <a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="any">packageJSON</span><span class="punctuation">.</span>version<span class="punctuation">,</span>
          <span id="17056" data-toggle="tooltip" data-title="boolean">isActive</span><span class="punctuation">:</span> <a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">isActive</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">isActive</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Activating ModalEdit...&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="keyword">try</span> <span class="punctuation">{</span>
            <span class="keyword">await</span> <a href="extension.html#16815"><span data-toggle="tooltip" data-title="vscode.Extension&lt;any&gt;">modalEditExt</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; Thenable&lt;any&gt;">activate</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;ModalEdit activated successfully&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span> <span class="keyword">catch</span> <span class="punctuation">(</span><span id="17348" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3275"><span class="member" data-toggle="tooltip" data-title="(message: string, error?: unknown) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">&#039;Failed to activate ModalEdit&#039;</span><span class="punctuation">,</span> <a href="extension.html#17348"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
            <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span>
              <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showWarningMessage</span><span class="punctuation">(</span>
                <span class="string">&#039;ModalEdit Line Indicator: Could not activate ModalEdit extension. &#039;</span> <span class="punctuation">+</span>
                  <span class="string">&#039;Mode detection may not work correctly.&#039;</span><span class="punctuation">,</span>
                <span class="string">&#039;Show Logs&#039;</span>
              <span class="punctuation">)</span>
              <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = &quot;Show Logs&quot; | undefined, TResult2 = never&gt;(onfulfilled?: ((value: &quot;Show Logs&quot; | undefined) =&gt; TResult1 | PromiseLike&lt;TResult1&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | ... 1 more ... | undefined) =&gt; PromiseLike&lt;...&gt;">then</span><span class="punctuation">(</span><span id="17699" data-toggle="tooltip" data-title="&quot;Show Logs&quot; | undefined">choice</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#17699"><span data-toggle="tooltip" data-title="&quot;Show Logs&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Show Logs&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                  <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3644"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">show</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
                <span class="punctuation">}</span>
              <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span>
        <span class="punctuation">}</span>

        <span class="comment">// Wait for ModalEdit to set its context</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Waiting for ModalEdit to initialize context...&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">await</span> <span class="keyword">new</span> <span class="typename" data-toggle="tooltip" data-title="PromiseConstructor">Promise</span><span class="punctuation">(</span><span id="18004" data-toggle="tooltip" data-title="(value: unknown) =&gt; void">resolve</span> <span class="punctuation">=&gt;</span> <span class="member" data-toggle="tooltip" data-title="typeof setTimeout">setTimeout</span><span class="punctuation">(</span><a href="extension.html#18004"><span data-toggle="tooltip" data-title="(value: unknown) =&gt; void">resolve</span></a><span class="punctuation">,</span> <span class="number">200</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Wait complete, proceeding with mode detection...&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span> <span class="keyword">else</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;⚠️  ModalEdit extension NOT FOUND - will default to insert mode&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="comment">// Test initial mode detection</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Testing initial mode detection...&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">const</span> <span id="18343" data-toggle="tooltip" data-title="Mode">initialMode</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#2621"><span class="member" data-toggle="tooltip" data-title="() =&gt; Mode">detectCurrentMode</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Initial mode result&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
        <span id="18430" data-toggle="tooltip" data-title="Mode">mode</span><span class="punctuation">:</span> <a href="extension.html#18343"><span data-toggle="tooltip" data-title="Mode">initialMode</span></a><span class="punctuation">,</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#9403"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">registerListeners</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Apply initial decorations</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;Applying initial decorations&#039;</span><span class="punctuation">,</span> <span class="punctuation">{</span>
        <span id="18592" data-toggle="tooltip" data-title="number">visibleEditors</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.TextEditor[]">visibleTextEditors</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">,</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">const</span> <span id="18685" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span> <span class="keyword">of</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.TextEditor[]">visibleTextEditors</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#5880"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor) =&gt; void">applyDecorations</span></a><span class="punctuation">(</span><a href="extension.html#18685"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="comment">// Start polling mode for instant mode change detection</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#15388"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">startModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== ACTIVATION COMPLETE ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span> <span class="keyword">catch</span> <span class="punctuation">(</span><span id="18941" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3275"><span class="member" data-toggle="tooltip" data-title="(message: string, error?: unknown) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">&#039;FATAL: Activation failed&#039;</span><span class="punctuation">,</span> <a href="extension.html#18941"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">throw</span> <a href="extension.html#18941"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">;</span> <span class="comment">// Re-throw so VS Code knows activation failed</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Dispose method required by vscode.Disposable interface
Clean up resources when extension is deactivated</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">public</span> <span id="19085" class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== DEACTIVATION START ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Stop mode polling</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#16383"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">stopModePolling</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Clear pending debounce timer</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">updateDebounceTimer</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="member" data-toggle="tooltip" data-title="(timeout: NodeJS.Timeout | string | number | undefined) =&gt; void">clearTimeout</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout">updateDebounceTimer</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#672"><span data-toggle="tooltip" data-title="NodeJS.Timeout | null">updateDebounceTimer</span></a> <span class="punctuation">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="comment">// Clear all decorations</span>
    <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.TextEditor[]">visibleTextEditors</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: vscode.TextEditor, index: number, array: readonly vscode.TextEditor[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span><span id="19584" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <a href="extension.html#19584"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#19584"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#19584"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="extension.html#19584"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(decorationType: vscode.TextEditorDecorationType, rangesOrOptions: readonly vscode.Range[] | readonly vscode.DecorationOptions[]) =&gt; void">setDecorations</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Dispose all listeners</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#623"><span data-toggle="tooltip" data-title="vscode.Disposable[]">disposables</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: vscode.Disposable, index: number, array: vscode.Disposable[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span><span id="19895" data-toggle="tooltip" data-title="vscode.Disposable">d</span> <span class="punctuation">=&gt;</span> <a href="extension.html#19895"><span data-toggle="tooltip" data-title="vscode.Disposable">d</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; any">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Dispose decoration types</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#275"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">normal</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#318"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">insert</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#361"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">visual</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#555"><span data-toggle="tooltip" data-title="DecorationTypes">decorations</span></a><span class="punctuation">.</span><a href="extension.html#404"><span data-toggle="tooltip" data-title="vscode.TextEditorDecorationType">search</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#2517"><span class="member" data-toggle="tooltip" data-title="(message: string, data?: unknown) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&#039;=== DEACTIVATION COMPLETE ===&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="extension.html#863"><span data-toggle="tooltip" data-title="ExtensionLogger">logger</span></a><span class="punctuation">.</span><a href="logging.html#3697"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="keyword">let</span> <span id="20195" data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span><span class="punctuation">:</span> <a href="extension.html#449"><span class="typename" data-toggle="tooltip" data-title="ModalEditLineIndicator">ModalEditLineIndicator</span></a><span class="punctuation">;</span>
</code></pre>
<p>Extension activation entry point
Called when VS Code loads the extension</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="20230" class="member" data-toggle="tooltip" data-title="(context: vscode.ExtensionContext) =&gt; void">activate</span><span class="punctuation">(</span><span id="20344" data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span><span class="punctuation">:</span> <a href="extension.html#6"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.ExtensionContext">ExtensionContext</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
  <a href="extension.html#20195"><span data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span></a> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="extension.html#449"><span class="typename" data-toggle="tooltip" data-title="typeof ModalEditLineIndicator">ModalEditLineIndicator</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <a href="extension.html#20344"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="{ dispose(): any; }[]">subscriptions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: { dispose(): any; }[]) =&gt; number">push</span><span class="punctuation">(</span><a href="extension.html#20195"><span data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

  <a href="extension.html#20195"><span data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span></a>
    <span class="punctuation">.</span><a href="extension.html#16616"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">activate</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = void, TResult2 = never&gt;(onfulfilled?: ((value: void) =&gt; TResult1 | PromiseLike&lt;TResult1&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | null | undefined) =&gt; Promise&lt;...&gt;">then</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <span class="comment">// Check if ModalEdit is installed</span>
      <span class="keyword">const</span> <span id="20570" data-toggle="tooltip" data-title="boolean">modalEditInstalled</span> <span class="punctuation">=</span> <span class="punctuation">!</span><span class="punctuation">!</span><a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.extensions">extensions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = any&gt;(extensionId: string) =&gt; vscode.Extension&lt;T&gt; | undefined">getExtension</span><span class="punctuation">(</span><span class="string">&#039;johtela.vscode-modaledit&#039;</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">const</span> <span id="20665" data-toggle="tooltip" data-title="false">hasSeenWarning</span> <span class="punctuation">=</span> <a href="extension.html#20344"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Memento &amp; { setKeysForSync(keys: readonly string[]): void; }">globalState</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(key: string): T | undefined; &lt;T&gt;(key: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&#039;hasSeenModalEditWarning&#039;</span><span class="punctuation">,</span> <span class="keyword">false</span><span class="punctuation">)</span><span class="punctuation">;</span>

      <span class="comment">// Show warning if ModalEdit not installed and user hasn&#039;t dismissed</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="extension.html#20570"><span data-toggle="tooltip" data-title="boolean">modalEditInstalled</span></a> <span class="punctuation">&amp;&amp;</span> <span class="punctuation">!</span><a href="extension.html#20665"><span data-toggle="tooltip" data-title="false">hasSeenWarning</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showWarningMessage</span><span class="punctuation">(</span>
            <span class="string">&#039;ModalEdit Line Indicator requires the ModalEdit extension for full functionality. &#039;</span> <span class="punctuation">+</span>
              <span class="string">&#039;Without ModalEdit, only insert mode styling will be displayed.&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Install ModalEdit&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Learn More&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Dismiss&#039;</span>
          <span class="punctuation">)</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = &quot;Install ModalEdit&quot; | &quot;Learn More&quot; | &quot;Dismiss&quot; | undefined, TResult2 = never&gt;(onfulfilled?: ((value: &quot;Install ModalEdit&quot; | &quot;Learn More&quot; | &quot;Dismiss&quot; | undefined) =&gt; TResult1 | PromiseLike&lt;TResult1&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | ... 1 more ... | undefine...">then</span><span class="punctuation">(</span><span id="21211" data-toggle="tooltip" data-title="&quot;Install ModalEdit&quot; | &quot;Learn More&quot; | &quot;Dismiss&quot; | undefined">choice</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#21211"><span data-toggle="tooltip" data-title="&quot;Install ModalEdit&quot; | &quot;Learn More&quot; | &quot;Dismiss&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Install ModalEdit&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <span class="comment">// Open extension search for ModalEdit</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span>
                <span class="string">&#039;workbench.extensions.search&#039;</span><span class="punctuation">,</span>
                <span class="string">&#039;@id:johtela.vscode-modaledit&#039;</span>
              <span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#21211"><span data-toggle="tooltip" data-title="&quot;Learn More&quot; | &quot;Dismiss&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Learn More&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <span class="comment">// Open Prerequisites documentation</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.env">env</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(target: vscode.Uri) =&gt; Thenable&lt;boolean&gt;">openExternal</span><span class="punctuation">(</span>
                <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Uri">Uri</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(value: string, strict?: boolean) =&gt; vscode.Uri">parse</span><span class="punctuation">(</span>
                  <span class="string">&#039;https://github.com/GoodDingo/modaledit-line-indicator/blob/main/README.md#prerequisites&#039;</span>
                <span class="punctuation">)</span>
              <span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#21211"><span data-toggle="tooltip" data-title="&quot;Dismiss&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Dismiss&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <span class="comment">// Store dismissal in globalState</span>
              <a href="extension.html#20344"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Memento &amp; { setKeysForSync(keys: readonly string[]): void; }">globalState</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(key: string, value: any) =&gt; Thenable&lt;void&gt;">update</span><span class="punctuation">(</span><span class="string">&#039;hasSeenModalEditWarning&#039;</span><span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span>
          <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>

      <span class="comment">// First-run welcome notification (only if ModalEdit IS installed)</span>
      <span class="keyword">const</span> <span id="22090" data-toggle="tooltip" data-title="true">isFirstRun</span> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="extension.html#20344"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Memento &amp; { setKeysForSync(keys: readonly string[]): void; }">globalState</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(key: string): T | undefined; &lt;T&gt;(key: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&#039;hasRun&#039;</span><span class="punctuation">,</span> <span class="keyword">false</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#22090"><span data-toggle="tooltip" data-title="true">isFirstRun</span></a> <span class="punctuation">&amp;&amp;</span> <a href="extension.html#20570"><span data-toggle="tooltip" data-title="boolean">modalEditInstalled</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span>
            <span class="string">&#039;ModalEdit Line Indicator active! Switch modes (Esc/i/v) to see line highlighting.&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Show Guide&#039;</span><span class="punctuation">,</span>
            <span class="string">&#039;Got It&#039;</span>
          <span class="punctuation">)</span>
          <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult1 = &quot;Show Guide&quot; | &quot;Got It&quot; | undefined, TResult2 = never&gt;(onfulfilled?: ((value: &quot;Show Guide&quot; | &quot;Got It&quot; | undefined) =&gt; TResult1 | PromiseLike&lt;TResult1&gt;) | null | undefined, onrejected?: ((reason: any) =&gt; TResult2 | PromiseLike&lt;...&gt;) | ... 1 more ... | undefined) =&gt; PromiseLike&lt;...&gt;">then</span><span class="punctuation">(</span><span id="22422" data-toggle="tooltip" data-title="&quot;Show Guide&quot; | &quot;Got It&quot; | undefined">choice</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#22422"><span data-toggle="tooltip" data-title="&quot;Show Guide&quot; | &quot;Got It&quot; | undefined">choice</span></a> <span class="punctuation">===</span> <span class="string">&#039;Show Guide&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
              <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.env">env</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(target: vscode.Uri) =&gt; Thenable&lt;boolean&gt;">openExternal</span><span class="punctuation">(</span>
                <a href="extension.html#6"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Uri">Uri</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(value: string, strict?: boolean) =&gt; vscode.Uri">parse</span><span class="punctuation">(</span>
                  <span class="string">&#039;https://github.com/GoodDingo/modaledit-line-indicator/blob/main/README.md#quick-start&#039;</span>
                <span class="punctuation">)</span>
              <span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="punctuation">}</span>
          <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <a href="extension.html#20344"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Memento &amp; { setKeysForSync(keys: readonly string[]): void; }">globalState</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(key: string, value: any) =&gt; Thenable&lt;void&gt;">update</span><span class="punctuation">(</span><span class="string">&#039;hasRun&#039;</span><span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;TResult = never&gt;(onrejected?: ((reason: any) =&gt; TResult | PromiseLike&lt;TResult&gt;) | null | undefined) =&gt; Promise&lt;void | TResult&gt;">catch</span><span class="punctuation">(</span><span id="22797" data-toggle="tooltip" data-title="any">error</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
      <span data-toggle="tooltip" data-title="Console">console</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(message?: any, ...optionalParams: any[]) =&gt; void">error</span><span class="punctuation">(</span><span class="string">&#039;Error activating ModalEdit Line Indicator:&#039;</span><span class="punctuation">,</span> <a href="extension.html#22797"><span data-toggle="tooltip" data-title="any">error</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre>
<p>Extension deactivation entry point
Called when VS Code unloads the extension</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="22891" class="member" data-toggle="tooltip" data-title="() =&gt; void">deactivate</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
  <span class="keyword">if</span> <span class="punctuation">(</span><a href="extension.html#20195"><span data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="extension.html#20195"><span data-toggle="tooltip" data-title="ModalEditLineIndicator">indicator</span></a><span class="punctuation">.</span><a href="extension.html#19085"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">dispose</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button disabled">
            Previous
        </a>
            <div class="footer-text">
                <p>Copyright © 2023</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button disabled">
            Next
        </a>
        </div>
    
        <script src="../dist/normal.js"></script>
    </body>
    </html>